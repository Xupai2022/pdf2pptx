# PDF to PPTX Converter Configuration

# PDF Parsing Configuration
parser:
  dpi: 300
  extract_images: true
  image_format: "PNG"
  min_text_size: 6
  max_text_size: 72
  
  # Chart detection configuration
  min_shapes_for_chart: 3  # Minimum number of shapes to form a chart
  cluster_distance_threshold: 50  # Max distance (pt) between shapes in same cluster
  min_chart_area: 10000  # Minimum chart area in pt²
  chart_render_dpi: 600  # DPI for rendering charts as images (higher = sharper)

# Layout Analysis Configuration
analyzer:
  title_threshold: 20  # Font size threshold for titles
  min_paragraph_chars: 10
  group_tolerance: 10  # Pixels tolerance for grouping elements
  detect_headers: true
  detect_footers: true
  
  # LayoutLM Enhancement (Optional - requires transformers + torch)
  use_layoutlm: true  # Enable LayoutLM semantic analysis
  layoutlm_model: "microsoft/layoutlmv3-base"
  layoutlm_device: "auto"  # 'auto', 'cuda', or 'cpu'
  
  # Intelligent triggering conditions (only use LayoutLM when needed)
  layoutlm_conditions:
    min_text_blocks: 20      # Enable if text blocks >= 20 (complex layout)
    complex_tables: true     # Enable if table detected
    multi_column: true       # Enable if multi-column layout detected

# Coordinate Mapping Configuration
rebuilder:
  # PowerPoint uses 72 DPI standard
  # Target slide size: 1920×1080 px (16:9 standard)
  slide_width: 26.667  # inches (1920px at 72 DPI = 1920/72 = 26.667")
  slide_height: 15.0  # inches (1080px at 72 DPI = 1080/72 = 15")
  margin_left: 0.0  # No margins to match HTML exactly
  margin_right: 0.0
  margin_top: 0.0
  margin_bottom: 0.0

  # PDF scale correction: NOW CALCULATED DYNAMICALLY based on PDF dimensions
  # The system automatically calculates the appropriate scale factor
  # for each PDF to ensure consistent visual sizing
  pdf_to_html_scale: 1.333  # Default fallback (used only if dynamic calculation fails)

  # Border width correction: PDF has 5.55pt borders → 7.4pt after scaling, but HTML expects 4pt
  # Correction factor: 4pt / 7.4pt = 0.54
  border_width_correction: 0.54

# Style Mapping Configuration
mapper:
  # Font mapping (PDF font -> PPT font)
  font_mapping:
    # Chinese fonts
    "SimHei": "微软雅黑"
    "SimSun": "宋体"
    "MicrosoftYaHei": "微软雅黑"
    "MicrosoftYaHei-Bold": "微软雅黑"
    "MicrosoftYaHeiUI": "微软雅黑"
    "Microsoft-YaHei": "微软雅黑"
    "KaiTi": "楷体"
    "FangSong": "仿宋"

    # Alternative mappings for UI fonts
    "Microsoft YaHei UI": "微软雅黑"
    "Microsoft YaHei Bold": "微软雅黑"

    # Western fonts
    "Helvetica": "Arial"
    "Helvetica-Bold": "Arial"
    "Times": "Times New Roman"
    "Times-Bold": "Times New Roman"
    "Courier": "Courier New"
    "Arial": "Arial"
    "Verdana": "Verdana"
    "Tahoma": "Tahoma"

  default_font: "Arial"
  default_font_size: 18
  title_font_size: 32

  # Font size scaling: NOW DYNAMICALLY MATCHES coordinate scaling
  # The system automatically adjusts font size scale to match the
  # coordinate scaling, ensuring consistent visual appearance
  # across PDFs of different dimensions
  font_size_scale: 1.333  # Default fallback (will be overridden dynamically)
  
  # Color schemes
  preserve_colors: true
  default_text_color: "#000000"
  
  # Semi-transparent color mapping (hex -> opacity) BY ROLE
  # NOTE: This transparency_map is now DISABLED because opacity is automatically
  # extracted from PDF ExtGState information. This provides accurate, universal
  # color recognition without hardcoding.
  # 
  # The map is kept for backward compatibility with PDFs that don't have
  # ExtGState opacity information, but it will only be used as a fallback
  # when PDF extraction returns opacity=1.0 (fully opaque).
  #
  # For most modern PDFs (including glm-4.6.pdf), opacity is extracted directly
  # from the PDF structure, ensuring 100% accuracy.
  transparency_map: {}

# PPTX Generation Configuration
generator:
  template: null  # Path to PPTX template (optional)
  slide_layout: "blank"  # blank, title, content, etc.
  preserve_layout: true
  compress_images: false
  image_quality: 95

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "pdf2pptx.log"
