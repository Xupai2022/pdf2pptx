# PDF to PPTX Converter Configuration

# PDF Parsing Configuration
parser:
  dpi: 300
  extract_images: true
  image_format: "PNG"
  min_text_size: 6
  max_text_size: 72

# Layout Analysis Configuration
analyzer:
  title_threshold: 20  # Font size threshold for titles
  min_paragraph_chars: 10
  group_tolerance: 10  # Pixels tolerance for grouping elements
  detect_headers: true
  detect_footers: true

# Coordinate Mapping Configuration
rebuilder:
  # PowerPoint uses 72 DPI standard
  # PDF is generated at 75% scale (1440×811 pt), need to scale back to 1920×1080 px
  slide_width: 26.667  # inches (1920px at 72 DPI = 1920/72 = 26.667")
  slide_height: 15.0  # inches (1080px at 72 DPI = 1080/72 = 15")
  margin_left: 0.0  # No margins to match HTML exactly
  margin_right: 0.0
  margin_top: 0.0
  margin_bottom: 0.0
  
  # PDF scale correction: PDF is 75% of HTML size, multiply by 1.333 to restore
  pdf_to_html_scale: 1.333  # 4/3 ratio to convert 1440×811 → 1920×1080
  
  # Border width correction: PDF has 5.55pt borders → 7.4pt after scaling, but HTML expects 4pt
  # Correction factor: 4pt / 7.4pt = 0.54
  border_width_correction: 0.54

# Style Mapping Configuration
mapper:
  # Font mapping (PDF font -> PPT font)
  font_mapping:
    "SimHei": "Microsoft YaHei"
    "SimSun": "宋体"
    "Helvetica": "Arial"
    "Times": "Times New Roman"
    "Courier": "Courier New"
  
  default_font: "Arial"
  default_font_size: 18
  title_font_size: 32
  
  # Font size scaling (PDF points to HTML pixels)
  # PDF is generated at 75% scale: 36pt in PDF = 48px in HTML
  # Scaling factor: 1.333 (4/3) converts PDF points to match HTML pixel sizes
  # At 72 DPI: 1 pt = 1 px, so 36pt × 1.333 = 48pt in PowerPoint = 48px equivalent
  font_size_scale: 1.333
  
  # Color schemes
  preserve_colors: true
  default_text_color: "#000000"
  
  # Semi-transparent color mapping (hex -> opacity) BY ROLE
  # IMPORTANT: Transparency is only applied to specific roles (card_background, not border/decoration)
  # Maps solid colors extracted from PDF to their intended RGBA opacity
  # Based on HTML reference: rgba(10, 66, 117, 0.08) and rgba(10, 66, 117, 0.03)
  transparency_map:
    # Card backgrounds (wide rectangles) - semi-transparent
    card_background:
      "#0a4275": 0.08  # Stat cards - HTML
      "#094174": 0.08  # Stat cards - PDF extracted
      "#e6f0f5": 0.08  # Alternative stat cards
      "#f5f9fa": 0.03  # Data cards (lighter)
    
    # Risk level badges - semi-transparent
    decoration:
      "#db2525": 0.1   # Red risk badges
      "#f59d0a": 0.1   # Orange risk badges  
      "#3b82f6": 0.1   # Blue risk badges
      "#3b81f5": 0.1   # Blue risk badges (variant)
    
    # Borders and top-bar - NO transparency (solid colors)
    # These are intentionally NOT in the map, so they remain opaque

# PPTX Generation Configuration
generator:
  template: null  # Path to PPTX template (optional)
  slide_layout: "blank"  # blank, title, content, etc.
  preserve_layout: true
  compress_images: false
  image_quality: 95

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "pdf2pptx.log"
